<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MiniClaudeCode.Avalonia.ViewModels"
             x:Class="MiniClaudeCode.Avalonia.Views.DiffEditorView"
             x:DataType="vm:DiffEditorViewModel">

    <Border Background="#1E1E2E" IsVisible="{Binding IsVisible}">
        <DockPanel>
            <!-- Header bar -->
            <Border DockPanel.Dock="Top"
                    Padding="10,6"
                    Background="#181825"
                    BorderBrush="#313244"
                    BorderThickness="0,0,0,1">
                <DockPanel>
                    <Button DockPanel.Dock="Right"
                            Content="&#x2715;"
                            Command="{Binding CloseCommand}"
                            FontSize="12" Padding="6,2"
                            Background="Transparent"
                            Foreground="#6C7086"
                            VerticalAlignment="Center" />

                    <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                        <TextBlock Text="&#x1F50D;" FontSize="12" />
                        <TextBlock Text="{Binding FileName}"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="#CDD6F4" />
                        <TextBlock Text="{Binding RelativePath}"
                                   FontSize="11"
                                   Foreground="#6C7086"
                                   Opacity="0.7" />
                        <Border Background="#313244" CornerRadius="3" Padding="6,1" Margin="8,0,0,0">
                            <TextBlock Text="{Binding StatsDisplay}"
                                       FontSize="10"
                                       Foreground="#A6E3A1"
                                       FontFamily="Cascadia Code, Consolas, monospace" />
                        </Border>
                    </StackPanel>
                </DockPanel>
            </Border>

            <!-- Diff content -->
            <ScrollViewer HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding DiffLines}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="vm:DiffLine">
                            <Border Background="{Binding Background}"
                                    Padding="0,0,8,0">
                                <DockPanel>
                                    <!-- Line numbers -->
                                    <TextBlock DockPanel.Dock="Left"
                                               Text="{Binding LineNumberDisplay}"
                                               FontFamily="Cascadia Code, Consolas, monospace"
                                               FontSize="11"
                                               Foreground="#6C7086"
                                               Opacity="0.5"
                                               Width="90"
                                               Padding="4,0"
                                               TextAlignment="Right" />

                                    <!-- Prefix (+/-/space) -->
                                    <TextBlock DockPanel.Dock="Left"
                                               Text="{Binding Prefix}"
                                               FontFamily="Cascadia Code, Consolas, monospace"
                                               FontSize="12"
                                               Foreground="{Binding Foreground}"
                                               Width="16"
                                               TextAlignment="Center" />

                                    <!-- Content -->
                                    <TextBlock Text="{Binding Content}"
                                               FontFamily="Cascadia Code, Consolas, monospace"
                                               FontSize="12"
                                               Foreground="{Binding Foreground}" />
                                </DockPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>
    </Border>
</UserControl>
