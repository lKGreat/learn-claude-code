<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MiniClaudeCode.Avalonia.ViewModels"
             x:Class="MiniClaudeCode.Avalonia.Views.MentionPickerView"
             x:DataType="vm:MentionPickerViewModel"
             IsVisible="{Binding IsVisible}"
             Width="350">

  <Border Background="#1E1E2E"
          BorderBrush="#313244"
          BorderThickness="1"
          CornerRadius="8"
          BoxShadow="0 4 12 0 #00000040"
          MaxHeight="400">
    <StackPanel Spacing="0">
      <!-- Header with search indicator -->
      <Border Background="#181825"
              Padding="12,8"
              BorderBrush="#313244"
              BorderThickness="0,0,0,1">
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock Text="@"
                     FontSize="14"
                     Foreground="#89B4FA"
                     FontWeight="Bold"
                     VerticalAlignment="Center" />
          <TextBlock Text="{Binding Query}"
                     FontSize="13"
                     Foreground="#CDD6F4"
                     VerticalAlignment="Center" />
          <TextBlock Text="(type to search files and symbols)"
                     FontSize="11"
                     Foreground="#6C7086"
                     Opacity="0.7"
                     VerticalAlignment="Center"
                     IsVisible="{Binding !Query.Length}" />
        </StackPanel>
      </Border>

      <!-- Results list -->
      <ScrollViewer MaxHeight="350"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Disabled">
        <ItemsControl ItemsSource="{Binding Items}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="vm:MentionItem">
              <Border x:Name="ItemBorder"
                      Padding="12,8"
                      Background="Transparent"
                      Cursor="Hand">
                <StackPanel Spacing="4">
                  <StackPanel Orientation="Horizontal" Spacing="8">
                    <!-- Icon -->
                    <TextBlock Text="{Binding Icon}"
                               FontSize="16"
                               VerticalAlignment="Center" />

                    <!-- Name -->
                    <TextBlock Text="{Binding Name}"
                               FontSize="13"
                               Foreground="#CDD6F4"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis" />

                    <!-- Category badge -->
                    <Border Background="#313244"
                            CornerRadius="3"
                            Padding="4,2"
                            VerticalAlignment="Center">
                      <TextBlock Text="{Binding Category}"
                                 FontSize="10"
                                 Foreground="#89B4FA"
                                 FontWeight="Medium" />
                    </Border>
                  </StackPanel>

                  <!-- Detail info -->
                  <TextBlock Text="{Binding Detail}"
                             FontSize="11"
                             Foreground="#6C7086"
                             Margin="24,0,0,0"
                             TextTrimming="CharacterEllipsis" />
                </StackPanel>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>

          <ItemsControl.Styles>
            <!-- Highlight selected item -->
            <Style Selector="Border:nth-child(1)">
              <Setter Property="Background" Value="#313244" />
            </Style>
          </ItemsControl.Styles>
        </ItemsControl>
      </ScrollViewer>

      <!-- Empty state -->
      <Border Padding="12,16"
              IsVisible="{Binding !Items.Count}">
        <TextBlock Text="Type to search files and symbols..."
                   FontSize="12"
                   Foreground="#6C7086"
                   HorizontalAlignment="Center"
                   TextAlignment="Center" />
      </Border>

      <!-- Footer with keyboard hints -->
      <Border Background="#181825"
              Padding="8,6"
              BorderBrush="#313244"
              BorderThickness="0,1,0,0"
              IsVisible="{Binding Items.Count}">
        <StackPanel Orientation="Horizontal" Spacing="16">
          <StackPanel Orientation="Horizontal" Spacing="4">
            <TextBlock Text="↑↓"
                       FontSize="10"
                       Foreground="#89B4FA"
                       FontFamily="Consolas, monospace" />
            <TextBlock Text="navigate"
                       FontSize="10"
                       Foreground="#6C7086" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Spacing="4">
            <TextBlock Text="↵"
                       FontSize="10"
                       Foreground="#89B4FA"
                       FontFamily="Consolas, monospace" />
            <TextBlock Text="select"
                       FontSize="10"
                       Foreground="#6C7086" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Spacing="4">
            <TextBlock Text="Esc"
                       FontSize="10"
                       Foreground="#89B4FA"
                       FontFamily="Consolas, monospace" />
            <TextBlock Text="close"
                       FontSize="10"
                       Foreground="#6C7086" />
          </StackPanel>
        </StackPanel>
      </Border>
    </StackPanel>
  </Border>

</UserControl>
